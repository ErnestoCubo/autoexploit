param(
    [Parameter(Mandatory)][string]$option
)

function Import-Modules {

    param (
        [Parameter(Mandatory)][string]$module
    )
    
    try {
        Write-Host "[*]Importing modules please wait . . .`n" -ForegroundColor Yellow
        Import-Module -Name (-join((Get-Item .).Fullname, $module)) -Force
        Write-Host  (-join((Get-Item .).Fullname, $module), " module imported") -ForegroundColor Yellow
    }
    catch {
        Write-Host "Error al importar el m√≥dulo" -ForegroundColor Red
        Write-Error $_
    }

}

function main {

    param(
        [Parameter(Mandatory)][string]$option,
        [Parameter()][switch]$list = $false
    )

    switch -Wildcard ($option) {
        "auto"{
            Write-Host "Automatic mode selected`n" -ForegroundColor Green
            Import-Modules -module \auto_module.psm1
            Start-Sleep -Seconds 3
            systemRecon
            findRecursive
            
        }
        "manual"{
            Write-Host "Manual mode selected" -fore Green

            if ($list) {
                Write-Host $list
            }
    }
        "help" {
            Write-Host "Help menu `n The options available are auto mode or manual config mode: `n -auto: automatic audit for privESC, it will try to search for plain text creds and files with extra permissions `n -manual: with -list the tool will display a list of the manual exploits, without -list and with -<exploit_name> "   -ForegroundColor Green
        }
        Default {
            Write-Host -NoNewline "Invalid option usage:" -ForegroundColor Red
            Write-Host "`n -option help for help `n -option auto for automatic audit `n -option manual for manual audit" -ForegroundColor Red
            
        }
    }

}

main -option $option