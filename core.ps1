function Import-Modules {

    param (
        [Parameter(Mandatory)][string]$module
    )
    
    try {
        Write-Host "[*]Importing modules please wait . . ." -fore Yellow

        Import-Module -Name (-join((Get-Item .).Fullname, $module))
        Write-Host  (-join((Get-Item .).Fullname, $module), " module imported") -fore Yellow
    }
    catch {
        Write-Host "Error al importar el m√≥dulo" -fore Red
        Write-Error $_
    }

}

function main {

    param(
        [Parameter(Mandatory)][string]$option,
        [Parameter()][switch]$list = $false
    )


    switch -Wildcard ($option) {
        "auto"{
            Write-Host "Automatic mode selected" -fore Green
            Import-Modules -module \auto_module.psm1
        }
        "manual"{
            Write-Host "Manual mode selected" -fore Green

            if ($list) {
                Write-Host $list
            }
    }
        "help" {
            Write-Host "Help menu `n The options available are auto mode or manual config mode: `n -auto: automatic audit for privESC, it will try to search for plain text creds and files with extra permissions `n -manual: with -list the tool will display a list of the manual exploits, without -list and with -<exploit_name> "   -fore Green
        }
        Default {
            Write-Host -NoNewline "Invalid option usage:" -fore Red
            Write-Host "`n -option help for help `n -option auto for automatic audit `n -option manual for manual audit" -fore Red
            
        }
    }

}

param(
    [Parameter(Mandatory)][string]$option
)

main -option $option